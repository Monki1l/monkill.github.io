// This is all they will see in your index.html
const WORKER_URL = 'https://monkill-api.q23lo2rj3e2ioh4.workers.dev/'; 

async function init() {
    const now = new Date();
    const past = new Date(now.getTime() - (7 * 24 * 60 * 60 * 1000));
    
    // We ask the worker for the data. No keys required!
    const res = await fetch(`${WORKER_URL}?start=${past.toISOString()}&end=${now.toISOString()}`);
    const data = await res.json();
    
    // 'data' contains the players and steam info already combined by the server
    const enriched = data.players.map(p => ({
        ...p,
        name: data.steam[p.steamid]?.personaname || p.steamid,
        avatar: data.steam[p.steamid]?.avatarfull || 'default_url'
    }));

    render(enriched);
}